		   Universal Binary Build on MacOS

---
Currently, using these instructions to build a 10.4 binary on 10.5 don't quite
work right. Using 'otool -L', it can be observed that iconv is version 7.0.0.
If you use xcode, that properly uses iconv 5.0.0. So, to do an official build,
use these instructions since they will build the supporting files properly.
Then use xcode to compile agilitybook. Copy that executable into the output
directory of the previous build:
From: .../AgilityBook/src/Projects/macos/<build>/Release/agilitybook.app/Contents/MacOS
To: .../AgilityBook/<build>/AgilityBook.app/Contents/MacOS
[Note, when compiling in xcode, make sure it compiles both architectures, not
just the active one. In Debug, it's set to active, in Release, that's now off]

-- Recommended configure options now include turning off iconv, so the above
step shouldn't be necessary anymore. But it is. Something in the makefiles...
---

0. gettext package (from MacPorts): http://gettext.darwinports.com/
   - Also, it's highly recommended to update svn (sudo port install svn)

1. Install boost from source - download and then extract to a directory
(i.e. boost_1_42_0)
> cd boost_1_42_0
- Optionally, you can build this - don't need to though.
> bjam toolset=darwin variant=debug threading=multi link=static architecture=combined

If you don't install them in the system directory set the BOOST_ROOT env var
to the root of the boost directory:
> export BOOST_ROOT=~/boost_1_42_0
-- This can also be set in ~/.MacOSX/environment.plist (property manager)

2. Download and install WxMac (wxWidgets) in a local directory
[see http://wiki.wxwidgets.org/Getting_started_on_OS_X]
This seems to be the preferred install method for wxWidgets and allows you to
change settings of the library w/o having to be root and it allows you to have
multiple versions simultaneously with different settings
-- Set WXWIN to point to this directory (makes paths easier to set)

extract the tar to a directory (i.e ~/wx/wxWidgets-n.n.n [$WXWIN])
- Apply all patches noted in Readme.txt
- See build/setupwx and build/setwxpath.
  - setupwx: Makes configuring WX easy.
    [Note: the configure output should show all libraries as either 'builtin' or 'no']
  - setwxpath: Makes configuring build environment easy.
> cd <build directory>
  - Name will always be "build-[ansi|unicode][-debug]"
> make

Now you need to put this version of wx-config on your path so when you make
agilitybook it picks this version of wxMac
> export PATH=$WXWIN/build-unicode:$PATH
(use ". ./setwxpath 2.8 unicode" to do this)

3. Build agilitybook as universal binary for PPC and Intel 32 bit architectures
> cd AgilityBook/
> autoconf
> mkdir build-unicode
> cd build-unicode
> ../configure CC=gcc-4.0 CXX=g++-4.0 LD=g++-4.0
> make dist

4a. To package the distribution bundle [optional] [note, I do not do this]
- open /Developer/Applications/Utilities/PackageMaker
- select the Open menu option and open the Package Maker package build/AgilityRecordBook.pmdoc
- select the Build option and save the package wherever you like.

4b. To create a disk image:
- Open /Applications/Utilities/Disk\ Utility
- Create a new image
- Selecting a 40MB image is good, 10 is too small.
- Once mounted, drag AgilityBook.app in. Change the mounted name.
- Unmount
- Click 'Convert' (in Disk Utility) and compress.
